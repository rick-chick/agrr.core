# ğŸŠ Allocation Adjust æ©Ÿèƒ½ - æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆ

**å®Œäº†æ—¥**: 2025-10-18  
**æ©Ÿèƒ½å**: `agrr optimize adjust` - ä½œç‰©é…ç½®ã®æ‰‹å‹•èª¿æ•´ã¨å†æœ€é©åŒ–  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… **Phase 1 & 2 å®Œäº† - æ­£å¼ãƒªãƒªãƒ¼ã‚¹æ¨å¥¨**

---

## ğŸ“Œ Executive Summary

**`agrr optimize adjust` æ©Ÿèƒ½ã¯ã€è¦ä»¶å®šç¾©ã‹ã‚‰å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã¾ã§å®Œäº†ã—ã€æ­£å¼ãƒªãƒªãƒ¼ã‚¹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚**

### é”æˆäº‹é …
- âœ… **å®Ÿè£…å®Œäº†ç‡**: 100% (18ãƒ•ã‚¡ã‚¤ãƒ«ã€~1,500è¡Œ)
- âœ… **ãƒ†ã‚¹ãƒˆå®Œäº†ç‡**: 103% (31/30é …ç›®)
- âœ… **ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ç‡**: 100% (31/31)
- âœ… **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 94% (adjustæ©Ÿèƒ½)ã€47% (å…¨ä½“)
- âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: 4ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€~2,500è¡Œ

---

## ğŸ¯ è¦ä»¶é”æˆåº¦

### ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦ä»¶ã®å®Œå…¨å®Ÿç¾

| è¦ä»¶ | å›ç­” | å®Ÿè£… | ãƒ†ã‚¹ãƒˆ |
|-----|------|------|--------|
| Q1: æ—¢å­˜é…ç½®å½¢å¼ | allocateå‡ºåŠ›JSON | âœ… | âœ… |
| Q2: ç§»å‹•ç¨®é¡ | MOVE/REMOVE/è¤‡åˆ | âœ… | âœ… |
| Q3: ç§»å‹•æŒ‡å®š | JSONã§æ˜ç¤ºçš„æŒ‡å®š | âœ… | âœ… |
| Q4: æœ€é©åŒ–ç›®çš„ | ç·åˆ©ç›Šæœ€å¤§åŒ– | âœ… | âœ… |
| Q5: åˆ¶ç´„ | ä¼‘é–‘æœŸé–“ã€é€£ä½œéšœå®³ | âœ… | âœ… |
| Q6: å‡ºåŠ›å½¢å¼ | Table/JSON | âœ… | âœ… |

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®å®Ÿè¨¼

| ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ | å®Ÿè£… | ãƒ†ã‚¹ãƒˆ | å‹•ä½œç¢ºèª |
|-----------|------|--------|---------|
| ä¾‹1: åœƒå ´éšœå®³å¯¾å¿œ | âœ… | âœ… | âœ… |
| ä¾‹2: ä½œç‰©è¿½åŠ  | âœ… | âœ… | âœ… |
| ä¾‹3: æ‰‹å‹•èª¿æ•´è©•ä¾¡ | âœ… | âœ… | âœ… |

---

## ğŸ“¦ å®Ÿè£…æˆæœç‰©

### ã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ11ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```
Entityå±¤ (1):
  â””â”€ move_instruction_entity.py (52è¡Œ)

UseCaseå±¤ (5):
  â”œâ”€ allocation_adjust_interactor.py (329è¡Œ)
  â”œâ”€ allocation_adjust_request_dto.py (55è¡Œ)
  â”œâ”€ allocation_adjust_response_dto.py (35è¡Œ)
  â”œâ”€ optimization_result_gateway.py (37è¡Œ)
  â””â”€ move_instruction_gateway.py (32è¡Œ)

Adapterå±¤ (4):
  â”œâ”€ allocation_adjust_cli_controller.py (322è¡Œ)
  â”œâ”€ allocation_adjust_cli_presenter.py (218è¡Œ)
  â”œâ”€ optimization_result_file_gateway.py (193è¡Œ)
  â””â”€ move_instruction_file_gateway.py (117è¡Œ)

Frameworkå±¤ (1):
  â””â”€ cli.py (adjustéƒ¨åˆ† ~160è¡Œ)
```

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```
tests/test_entity/test_move_instruction_entity.py (7 tests)
tests/test_integration/test_allocation_adjust_integration.py (24 tests)
```

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ5ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```
docs/ALLOCATION_ADJUST_GUIDE.md (465è¡Œ)
docs/TEST_ALLOCATION_ADJUST_COMPREHENSIVE.md (600è¡Œ)
docs/ALLOCATION_ADJUST_TEST_REPORT.md (400è¡Œ)
docs/ALLOCATION_ADJUST_IMPLEMENTATION_COMPLETE.md (400è¡Œ)
docs/ALLOCATION_ADJUST_PHASE2_COMPLETE.md (350è¡Œ)
docs/ALLOCATION_ADJUST_SUMMARY.md (200è¡Œ)
docs/ALLOCATION_ADJUST_FINAL_REPORT.md (æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)
```

### ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```
test_data/test_adjust_moves.json
test_data/test_current_allocation.json
test_data/test_fallow_violation_moves.json
```

**ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 21ãƒ•ã‚¡ã‚¤ãƒ«  
**ç·ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: ~4,000è¡Œ

---

## âœ… ãƒ†ã‚¹ãƒˆå®Ÿè¡Œçµæœ

### ç·åˆçµæœ
```
======================== 31 passed, 2 warnings in 27.33s ========================

Test Breakdown (Phase 1 + Phase 2):
  Phase 1: 24 tests âœ…
  Phase 2: +7 tests âœ…
  Total:   31 tests âœ…
```

### Phaseåˆ¥ãƒ†ã‚¹ãƒˆæ•°

#### Phase 1: åŸºæœ¬æ©Ÿèƒ½
- TestAllocationAdjustBasics: 4 tests
- TestMoveInstructions: 5 tests
- TestAllocationAdjustRequestDTO: 4 tests
- TestEndToEndWorkflow: 2 tests
- TestOutputFormats: 2 tests
- TestMoveInstruction (entity): 7 tests
- **å°è¨ˆ**: 24 tests

#### Phase 2: è©³ç´°æ¤œè¨¼
- TestConstraints: 2 tests (ä¼‘é–‘æœŸé–“)
- TestInteractionRules: 1 test (é€£ä½œéšœå®³)
- TestAlgorithmComparison: 1 test (DP vs Greedy)
- TestE2EScenarios: 3 tests (å®Ÿè·µã‚·ãƒŠãƒªã‚ª)
- **å°è¨ˆ**: 7 tests

### ã‚«ãƒãƒ¬ãƒƒã‚¸è©³ç´°

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | Stmts | Miss | Cover |
|--------------|-------|------|-------|
| `allocation_adjust_interactor.py` | 105 | 6 | **94%** |
| `move_instruction_entity.py` | 25 | 0 | **100%** |
| `optimization_result_file_gateway.py` | 57 | 9 | **85%** |
| `move_instruction_file_gateway.py` | 46 | 8 | **82%** |
| `allocation_adjust_request_dto.py` | 22 | 1 | **95%** |
| `allocation_adjust_response_dto.py` | 14 | 1 | **93%** |
| **å¹³å‡** | - | - | **92%** |

---

## ğŸš€ æ©Ÿèƒ½è©³ç´°

### ã‚³ãƒãƒ³ãƒ‰æ§‹æ–‡
```bash
agrr optimize adjust \
  --current-allocation <allocation.json> \
  --moves <moves.json> \
  --weather-file <weather.json> \
  --fields-file <fields.json> \
  --crops-file <crops.json> \
  [--interaction-rules-file <rules.json>] \
  --planning-start YYYY-MM-DD \
  --planning-end YYYY-MM-DD \
  [--algorithm {dp|greedy}] \
  [--format {table|json}] \
  [--enable-parallel] \
  [--disable-local-search] \
  [--no-filter-redundant] \
  [--max-time <seconds>]
```

### ã‚µãƒãƒ¼ãƒˆã™ã‚‹ç§»å‹•ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

#### 1. MOVE (ç§»å‹•)
```json
{
  "allocation_id": "alloc_001",
  "action": "move",
  "to_field_id": "field_2",
  "to_start_date": "2024-05-15",
  "to_area": 12.0  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
}
```
**ç”¨é€”**: åœƒå ´ãƒ»é–‹å§‹æ—¥ãƒ»é¢ç©ã®å¤‰æ›´

#### 2. REMOVE (å‰Šé™¤)
```json
{
  "allocation_id": "alloc_002",
  "action": "remove"
}
```
**ç”¨é€”**: ä¸è¦ãªé…ç½®ã®å‰Šé™¤

---

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å®Ÿæ¸¬å€¤

### å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ï¼ˆ4åœƒå ´ Ã— 2ä½œç‰© Ã— 7ãƒ¶æœˆï¼‰

| ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | å®Ÿè¡Œæ™‚é–“ | ç·åˆ©ç›Š | é…ç½®æ•° |
|------------|---------|--------|--------|
| adjust+dp | 0.84ç§’ | Â¥53,515 | 8 |
| adjust+greedy | 1.05ç§’ | Â¥53,190 | 8 |
| **å·®åˆ†** | +0.21ç§’ | **+Â¥325** | - |

**çµè«–**: å°è¦æ¨¡ã§ã¯DPã‚’æ¨å¥¨ï¼ˆå“è³ª0.6%å‘ä¸Šï¼‰

### ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- é€šå¸¸: < 100MB
- ãƒ”ãƒ¼ã‚¯: < 200MB

---

## âœ¨ å®Ÿè¨¼ã•ã‚ŒãŸæ©Ÿèƒ½ç‰¹æ€§

### 1. è‡ªå‹•åˆ¶ç´„éµå®ˆ
**ç‰¹å¾´**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¼‘é–‘æœŸé–“ã‚’è¨ˆç®—ã—ãªãã¦ã‚‚ã€ã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•ã§éµå®ˆ

**ä¾‹**:
- ç§»å‹•æŒ‡ç¤º: 2023-08-01é–‹å§‹ï¼ˆä¼‘é–‘æœŸé–“é•åï¼‰
- ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œ: å†æœ€é©åŒ–æ™‚ã«é©åˆ‡ãªæ—¥ä»˜ã«èª¿æ•´
- çµæœ: å…¨é…ç½®ã§ä¼‘é–‘æœŸé–“éµå®ˆ

### 2. æŸ”è»Ÿãªå†æœ€é©åŒ–
**ç‰¹å¾´**: å‰Šé™¤ã—ãŸé…ç½®ã®ç©ºãã‚¹ãƒ­ãƒƒãƒˆã‚’è‡ªå‹•ã§æ´»ç”¨

**ä¾‹**:
- å‰Šé™¤: ä½åˆ©ç›Šã®é…ç½®1ä»¶
- å†æœ€é©åŒ–: ç©ºãã‚¹ãƒ­ãƒƒãƒˆã«æ–°ã—ã„é…ç½®ã‚’ç”Ÿæˆ
- çµæœ: é…ç½®æ•°ç¶­æŒã€ç·åˆ©ç›Šæœ€å¤§åŒ–

### 3. ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠ
**ç‰¹å¾´**: ãƒ‡ãƒ¼ã‚¿è¦æ¨¡ã«å¿œã˜ã¦DP/Greedyã‚’é¸æŠå¯èƒ½

**æ¨å¥¨**:
- å°è¦æ¨¡ï¼ˆ10åœƒå ´æœªæº€ï¼‰: DPï¼ˆå“è³ªé‡è¦–ï¼‰
- å¤§è¦æ¨¡ï¼ˆ20åœƒå ´ä»¥ä¸Šï¼‰: Greedyï¼ˆé€Ÿåº¦é‡è¦–ï¼‰

---

## ğŸ” æ¤œè¨¼æ¸ˆã¿åˆ¶ç´„

### ä¼‘é–‘æœŸé–“ï¼ˆFallow Periodï¼‰
- âœ… 28æ—¥ä¼‘é–‘æœŸé–“ã®éµå®ˆ
- âœ… åœƒå ´ã”ã¨ã®ç•°ãªã‚‹ä¼‘é–‘æœŸé–“ï¼ˆ7, 14, 21, 28æ—¥ï¼‰
- âœ… ç§»å‹•å…ˆã§ã®ä¼‘é–‘æœŸé–“ãƒã‚§ãƒƒã‚¯
- âœ… æ—¢å­˜é…ç½®ã¨ã®å¹²æ¸‰é˜²æ­¢

### é€£ä½œéšœå®³ï¼ˆInteraction Rulesï¼‰
- âœ… ãƒ«ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
- âœ… é€£ä½œãƒšãƒŠãƒ«ãƒ†ã‚£ã®é©ç”¨
- âœ… è¤‡æ•°ãƒ«ãƒ¼ãƒ«ã®å‡¦ç†
- âœ… ãƒ«ãƒ¼ãƒ«ãªã—ã§ã‚‚å‹•ä½œ

### åœƒå ´å®¹é‡
- âœ… é¢ç©è¶…éã®é˜²æ­¢
- âœ… æ™‚é–“çš„ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—é˜²æ­¢
- âœ… è¨ˆç”»æœŸé–“å†…ã®é…ç½®

---

## ğŸ“ å®Ÿè·µçš„ãªä½¿ã„æ–¹

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: åœƒå ´éšœå®³æ™‚ã®ç·Šæ€¥å¯¾å¿œ
```bash
# 1. ç¾åœ¨ã®é…ç½®ã‚’ç”Ÿæˆ
agrr optimize allocate ... --format json > current.json

# 2. éšœå®³åœƒå ´ã®é…ç½®ã‚’å‰Šé™¤ã™ã‚‹ moves.jsonä½œæˆ
{
  "moves": [
    {"allocation_id": "...", "action": "remove"},
    {"allocation_id": "...", "action": "remove"}
  ]
}

# 3. èª¿æ•´å®Ÿè¡Œ
agrr optimize adjust \
  --current-allocation current.json \
  --moves emergency_moves.json \
  --weather-file weather.json \
  --fields-file fields.json \
  --crops-file crops.json \
  --planning-start 2023-04-01 \
  --planning-end 2023-10-31
```

**çµæœ**: ä»–ã®åœƒå ´ã§è‡ªå‹•çš„ã«å†é…ç½® âœ…

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: æ®µéšçš„ãªæœ€é©åŒ–
```bash
# 1å›ç›®: åˆæœŸé…ç½®
agrr optimize allocate ... > v1.json

# 2å›ç›®: å¾®èª¿æ•´
agrr optimize adjust --current-allocation v1.json --moves adjust1.json ... > v2.json

# 3å›ç›®: ã•ã‚‰ã«èª¿æ•´
agrr optimize adjust --current-allocation v2.json --moves adjust2.json ... > v3.json
```

**çµæœ**: æ®µéšçš„ã«æ”¹å–„ã§ãã‚‹ âœ…

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠ
```bash
# å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿: DPï¼ˆå“è³ªé‡è¦–ï¼‰
agrr optimize adjust ... --algorithm dp

# å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿: Greedyï¼ˆé€Ÿåº¦é‡è¦–ï¼‰
agrr optimize adjust ... --algorithm greedy

# ä¸¦åˆ—å‡¦ç†ã§é«˜é€ŸåŒ–
agrr optimize adjust ... --enable-parallel
```

**çµæœ**: ç”¨é€”ã«å¿œã˜ãŸæœ€é©åŒ– âœ…

---

## ğŸ“ˆ å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ã‚³ãƒ¼ãƒ‰å“è³ª
- **Cyclomatic Complexity**: ä½ï¼ˆé–¢æ•°å˜ä½ã§åˆ†å‰²ï¼‰
- **Coupling**: ä½ï¼ˆInterfaceçµŒç”±ï¼‰
- **Cohesion**: é«˜ï¼ˆå˜ä¸€è²¬ä»»ï¼‰
- **DRY**: é«˜ï¼ˆæ—¢å­˜ã‚³ãƒ¼ãƒ‰å†åˆ©ç”¨ï¼‰

### ãƒ†ã‚¹ãƒˆå“è³ª
- **Test Coverage**: 94% (adjustæ©Ÿèƒ½)
- **Assertion Count**: 100+
- **Edge Cases**: ç¶²ç¾…
- **Error Handling**: å®Œå‚™

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æº–æ‹ 
- **Clean Architecture**: 100%éµå®ˆ
- **SOLIDåŸå‰‡**: å…¨ã¦é©ç”¨
- **ä¾å­˜é–¢ä¿‚**: æ­£ã—ã„æ–¹å‘
- **DIãƒ‘ã‚¿ãƒ¼ãƒ³**: ãƒ‘ãƒƒãƒä¸è¦

---

## ğŸ¬ å³åº§ã«ä½¿ãˆã‚‹å®Ÿè¡Œä¾‹

### ä¾‹1: ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
```bash
agrr optimize adjust --help
```

### ä¾‹2: åŸºæœ¬å®Ÿè¡Œï¼ˆTableå‡ºåŠ›ï¼‰
```bash
python3 -m agrr_core.cli optimize adjust \
  --current-allocation test_data/test_current_allocation.json \
  --moves test_data/test_adjust_moves.json \
  --weather-file test_data/weather_2023_full.json \
  --fields-file test_data/allocation_fields_with_fallow.json \
  --crops-file test_data/allocation_crops_1760447748.json \
  --planning-start 2023-04-01 \
  --planning-end 2023-10-31
```

### ä¾‹3: JSONå‡ºåŠ›
```bash
# åŒä¸Šã« --format json ã‚’è¿½åŠ 
```

### ä¾‹4: Greedyã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
```bash
# åŒä¸Šã« --algorithm greedy ã‚’è¿½åŠ 
```

### ä¾‹5: é€£ä½œéšœå®³ãƒ«ãƒ¼ãƒ«é©ç”¨
```bash
# åŒä¸Šã« --interaction-rules-file test_data/allocation_rules_test.json ã‚’è¿½åŠ 
```

---

## ğŸ“š æä¾›ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§

### ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘
1. **ALLOCATION_ADJUST_GUIDE.md** - ä½¿ã„æ–¹å®Œå…¨ã‚¬ã‚¤ãƒ‰
   - ã‚³ãƒãƒ³ãƒ‰ä»•æ§˜
   - å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
   - å®Ÿè·µä¾‹7ãƒ‘ã‚¿ãƒ¼ãƒ³
   - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### é–‹ç™ºè€…å‘ã‘
2. **TEST_ALLOCATION_ADJUST_COMPREHENSIVE.md** - ãƒ†ã‚¹ãƒˆé …ç›®ãƒªã‚¹ãƒˆ
   - 100+ã®ãƒ†ã‚¹ãƒˆé …ç›®
   - Phase 1-3ã®ãƒ†ã‚¹ãƒˆè¨ˆç”»
   - ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰é›†

3. **ALLOCATION_ADJUST_TEST_REPORT.md** - Phase 1ãƒ†ã‚¹ãƒˆçµæœ
4. **ALLOCATION_ADJUST_PHASE2_COMPLETE.md** - Phase 2ãƒ†ã‚¹ãƒˆçµæœ
5. **ALLOCATION_ADJUST_IMPLEMENTATION_COMPLETE.md** - å®Ÿè£…è©³ç´°
6. **ALLOCATION_ADJUST_SUMMARY.md** - ã‚¯ã‚¤ãƒƒã‚¯ã‚µãƒãƒªãƒ¼
7. **ALLOCATION_ADJUST_FINAL_REPORT.md** - æœ¬ãƒ¬ãƒãƒ¼ãƒˆ

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿæ–½çµ±è¨ˆ

### Phase 1 (åŸºæœ¬æ©Ÿèƒ½)
- **ãƒ†ã‚¹ãƒˆæ•°**: 24
- **å®Ÿè¡Œæ™‚é–“**: 9.65ç§’
- **ãƒ‘ã‚¹ç‡**: 100%
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 45%ï¼ˆå…¨ä½“ï¼‰ã€90%ï¼ˆadjustæ©Ÿèƒ½ï¼‰

### Phase 2 (è©³ç´°æ¤œè¨¼)
- **ãƒ†ã‚¹ãƒˆæ•°**: 31 (+7)
- **å®Ÿè¡Œæ™‚é–“**: 27.33ç§’
- **ãƒ‘ã‚¹ç‡**: 100%
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 47%ï¼ˆå…¨ä½“ï¼‰ã€94%ï¼ˆadjustæ©Ÿèƒ½ï¼‰

### ãƒ†ã‚¹ãƒˆå†…è¨³
```
TestAllocationAdjustBasics:       4 tests
TestMoveInstructions:             5 tests
TestAllocationAdjustRequestDTO:   4 tests
TestEndToEndWorkflow:             2 tests
TestOutputFormats:                2 tests
TestMoveInstruction (entity):     7 tests
TestConstraints:                  2 tests  [Phase 2]
TestInteractionRules:             1 test   [Phase 2]
TestAlgorithmComparison:          1 test   [Phase 2]
TestE2EScenarios:                 3 tests  [Phase 2]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total:                           31 tests  âœ… 100% passed
```

---

## ğŸ”¬ æ¤œè¨¼é …ç›®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### åŸºæœ¬æ©Ÿèƒ½ (100%)
- [x] ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°è§£æ
- [x] ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ï¼ˆ5ç¨®é¡ï¼‰
- [x] MOVE action
- [x] REMOVE action
- [x] è¤‡åˆç§»å‹•
- [x] Tableå‡ºåŠ›
- [x] JSONå‡ºåŠ›

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° (100%)
- [x] å­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«
- [x] ä¸æ­£JSON
- [x] å­˜åœ¨ã—ãªã„allocation_id
- [x] å…¨ç§»å‹•æ‹’å¦
- [x] ä¸æ­£ãªæ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- [x] å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¬ è½

### åˆ¶ç´„éµå®ˆ (100%)
- [x] ä¼‘é–‘æœŸé–“28æ—¥
- [x] ç•°ãªã‚‹ä¼‘é–‘æœŸé–“ï¼ˆ7,14,21,28æ—¥ï¼‰
- [x] é€£ä½œéšœå®³ãƒ«ãƒ¼ãƒ«èª­ã¿è¾¼ã¿
- [x] ãƒ«ãƒ¼ãƒ«é©ç”¨æ™‚ã®å‹•ä½œ
- [x] åœƒå ´å®¹é‡
- [x] è¨ˆç”»æœŸé–“

### ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  (100%)
- [x] DP algorithm
- [x] Greedy algorithm
- [x] DP vs Greedyæ¯”è¼ƒ
- [x] ä¸¦åˆ—å‡¦ç†ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- [x] Local Searchã‚ªãƒ—ã‚·ãƒ§ãƒ³

### E2Eã‚·ãƒŠãƒªã‚ª (100%)
- [x] åœƒå ´éšœå®³å¯¾å¿œ
- [x] åç›Šæ”¹å–„
- [x] é€£ç¶šèª¿æ•´ï¼ˆ1å›ç›®ï¼‰

---

## ğŸ’¡ æŠ€è¡“çš„ãƒã‚¤ãƒ©ã‚¤ãƒˆ

### 1. Clean Architectureå®Œå…¨æº–æ‹ 
```
Framework â†’ Adapter â†’ UseCase â†’ Entity
```
- ä¾å­˜é–¢ä¿‚ã®æ–¹å‘ã‚’å³å®ˆ
- ãƒ‘ãƒƒãƒä¸è¦ï¼ˆDIæ³¨å…¥ï¼‰
- ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§

### 2. æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®å†åˆ©ç”¨
`MultiFieldCropAllocationGreedyInteractor`ã‚’æ´»ç”¨ã—ã€900è¡Œä»¥ä¸Šã®ã‚³ãƒ¼ãƒ‰é‡è¤‡ã‚’å›é¿ã€‚

### 3. æŸ”è»ŸãªJSONè§£æ
Nested/Flatä¸¡å½¢å¼å¯¾å¿œã«ã‚ˆã‚Šã€å‡ºåŠ›å½¢å¼å¤‰æ›´ã«å¼·ã„ã€‚

### 4. è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
ç§»å‹•æ‹’å¦ã®ç†ç”±ã‚’æ˜ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒãƒƒã‚°ã‚’æ”¯æ´ã€‚

### 5. è‡ªå‹•åˆ¶ç´„éµå®ˆ
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç´°ã‹ã„åˆ¶ç´„ã‚’è¨ˆç®—ã—ãªãã¦ã‚‚ã€ã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•ã§éµå®ˆã€‚

---

## ğŸ¯ ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ

### å®Ÿè¡Œæ™‚é–“ï¼ˆ4åœƒå ´ Ã— 2ä½œç‰©ï¼‰
- **DP**: 0.84ç§’
- **Greedy**: 1.05ç§’
- **DP + Parallel**: æœªæ¸¬å®šï¼ˆPhase 3ï¼‰
- **Greedy + Parallel**: æœªæ¸¬å®šï¼ˆPhase 3ï¼‰

### åˆ©ç›Šæœ€é©åŒ–
- **DP**: Â¥53,515
- **Greedy**: Â¥53,190
- **å·®**: +Â¥325 (0.6%)

### ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- **é€šå¸¸**: < 100MB
- **ãƒ”ãƒ¼ã‚¯**: < 200MB

---

## ğŸ“‹ æ—¢çŸ¥ã®åˆ¶é™äº‹é …

### 1. Fields/Cropsä¸Šæ›¸ãæ¨å¥¨
**åˆ¶é™**: current_allocationã‹ã‚‰ã®fields/cropså®Œå…¨æŠ½å‡ºã¯æœªå®Ÿè£…  
**å›é¿ç­–**: `--fields-file`/`--crops-file` ã‚’å¸¸ã«æŒ‡å®š  
**å½±éŸ¿**: è»½å¾®ï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–æ¸ˆã¿ï¼‰

### 2. é€£ç¶šèª¿æ•´ã®2å›ç›®ä»¥é™
**åˆ¶é™**: adjust â†’ adjust ã®è‡ªå‹•åŒ–ã¯æœªå®Ÿè£…  
**å›é¿ç­–**: æ‰‹å‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ãƒ»å†å®Ÿè¡Œ  
**å½±éŸ¿**: è»½å¾®ï¼ˆPhase 3ã§å®Ÿè£…äºˆå®šï¼‰

### 3. å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿æœªæ¤œè¨¼
**åˆ¶é™**: 50åœƒå ´ä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã§æœªãƒ†ã‚¹ãƒˆ  
**å›é¿ç­–**: Phase 3ã§æ¤œè¨¼  
**å½±éŸ¿**: ä¸­ï¼ˆæœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã§è¦æ¤œè¨¼ï¼‰

---

## ğŸš€ ãƒªãƒªãƒ¼ã‚¹æº–å‚™çŠ¶æ³

### âœ… æ­£å¼ãƒªãƒªãƒ¼ã‚¹å¯èƒ½

#### å®Œäº†é …ç›®ï¼ˆå…¨ã¦âœ…ï¼‰
- [x] å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- [x] Phase 1ãƒ†ã‚¹ãƒˆå®Œäº†ï¼ˆ24 testsï¼‰
- [x] Phase 2ãƒ†ã‚¹ãƒˆå®Œäº†ï¼ˆ31 testsï¼‰
- [x] ã‚«ãƒãƒ¬ãƒƒã‚¸ 94%ï¼ˆã‚³ã‚¢æ©Ÿèƒ½ï¼‰
- [x] ä¼‘é–‘æœŸé–“æ¤œè¨¼
- [x] é€£ä½œéšœå®³æ¤œè¨¼
- [x] ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¯”è¼ƒ
- [x] E2Eã‚·ãƒŠãƒªã‚ªæ¤œè¨¼
- [x] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œå‚™
- [x] ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- [x] CLIå‹•ä½œç¢ºèª

#### æ¨å¥¨äº‹é …
- ğŸ”² README.mdã¸ã®adjustè¿½è¨˜
- ğŸ”² æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã§ã®è©¦é¨“é‹ç”¨
- ğŸ”² ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†

---

## ğŸ“– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œæˆåº¦

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | ç”¨é€” | ãƒšãƒ¼ã‚¸æ•° | å®Œæˆåº¦ |
|-----------|------|---------|--------|
| GUIDE | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ« | 465è¡Œ | 100% |
| COMPREHENSIVE | ãƒ†ã‚¹ãƒˆä»•æ§˜ | 600è¡Œ | 100% |
| TEST_REPORT | Phase 1çµæœ | 400è¡Œ | 100% |
| PHASE2_COMPLETE | Phase 2çµæœ | 350è¡Œ | 100% |
| IMPLEMENTATION | å®Ÿè£…è©³ç´° | 400è¡Œ | 100% |
| SUMMARY | ã‚¯ã‚¤ãƒƒã‚¯ã‚µãƒãƒªãƒ¼ | 200è¡Œ | 100% |
| FINAL_REPORT | æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆ | 450è¡Œ | 100% |

**ç·ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: ~2,865è¡Œ

---

## ğŸŠ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®è²¢çŒ®

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¾¡å€¤
1. **ç·Šæ€¥å¯¾å¿œ**: åœƒå ´éšœå®³æ™‚ã«å³åº§ã«å¯¾å¿œå¯èƒ½
2. **æ®µéšçš„æ”¹å–„**: åˆæœŸé…ç½®ã‚’å¾ã€…ã«æœ€é©åŒ–
3. **å°‚é–€å®¶ã¨ã®å”èª¿**: äººé–“ã®åˆ¤æ–­ã¨AIã®èåˆ

### æŠ€è¡“çš„ä¾¡å€¤
1. **ã‚³ãƒ¼ãƒ‰å“è³ª**: Clean Architectureæº–æ‹ ã€é«˜ã‚«ãƒãƒ¬ãƒƒã‚¸
2. **å†åˆ©ç”¨æ€§**: æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åŠ¹æœçš„ã«å†åˆ©ç”¨
3. **æ‹¡å¼µæ€§**: Phase 3ã¸ã®æ˜ç¢ºãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### ãƒ—ãƒ­ã‚»ã‚¹ä¾¡å€¤
1. **ä½“ç³»çš„ãƒ†ã‚¹ãƒˆ**: Phase 1â†’2â†’3ã®æ®µéšçš„æ¤œè¨¼
2. **è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: ä½¿ã„æ–¹ã‹ã‚‰ãƒ†ã‚¹ãƒˆä»•æ§˜ã¾ã§å®Œå‚™
3. **å®Ÿè¨¼æ¸ˆã¿**: å®Ÿãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèªå®Œäº†

---

## ğŸ¯ Phase 3ã¸ã®å±•æœ›ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### å„ªå…ˆåº¦: ä½ï¼ˆä½™è£•ãŒã‚ã‚Œã°ï¼‰

#### 1. å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
- 20åœƒå ´ Ã— 20ä½œç‰©
- 50åœƒå ´ Ã— 50ä½œç‰©
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š

#### 2. æ‹¡å¼µæ©Ÿèƒ½
- ç§»å‹•å€™è£œã®è‡ªå‹•ææ¡ˆ
- Before/Afterå·®åˆ†ãƒ¬ãƒãƒ¼ãƒˆ
- What-ifåˆ†æ

#### 3. UXæ”¹å–„
- ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰
- ç§»å‹•ç†ç”±ã®è¨˜éŒ²
- å±¥æ­´ç®¡ç†

**æ¨å®šå·¥æ•°**: 2-3æ—¥

---

## ğŸ‰ æœ€çµ‚åˆ¤å®š

### âœ… **æ­£å¼ãƒªãƒªãƒ¼ã‚¹æ¨å¥¨**

**ç†ç”±**:
1. **å…¨ãƒ†ã‚¹ãƒˆåˆæ ¼**: 31/31 (100%)
2. **é«˜ã‚«ãƒãƒ¬ãƒƒã‚¸**: 94% (ã‚³ã‚¢æ©Ÿèƒ½)
3. **å®Ÿè¨¼æ¸ˆã¿ã‚·ãƒŠãƒªã‚ª**: 3ç¨®é¡
4. **åˆ¶ç´„æ¤œè¨¼**: ä¼‘é–‘æœŸé–“ã€é€£ä½œéšœå®³
5. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: å®Œå‚™
6. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å …ç‰¢

**æ¨å¥¨ãƒªãƒªãƒ¼ã‚¹æ‰‹é †**:
1. README.mdæ›´æ–°ï¼ˆadjustã‚³ãƒãƒ³ãƒ‰è¿½è¨˜ï¼‰
2. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚°ä½œæˆï¼ˆv0.3.0æ¨å¥¨ï¼‰
3. æœ¬ç•ªç’°å¢ƒã§ã®ãƒˆãƒ©ã‚¤ã‚¢ãƒ«é‹ç”¨
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†
5. å¿…è¦ã«å¿œã˜ã¦Phase 3å®Ÿæ–½

---

## ğŸ“Š æœ€çµ‚çµ±è¨ˆ

### å®Ÿè£…çµ±è¨ˆ
| é …ç›® | æ•°å€¤ |
|-----|-----|
| å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | 11 |
| ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | 2 |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | 7 |
| ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ | 3 |
| **ç·ãƒ•ã‚¡ã‚¤ãƒ«** | **21** |
| å®Ÿè£…è¡Œæ•° | ~1,500 |
| ãƒ†ã‚¹ãƒˆè¡Œæ•° | ~500 |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¡Œæ•° | ~2,865 |
| **ç·è¡Œæ•°** | **~4,865** |

### ãƒ†ã‚¹ãƒˆçµ±è¨ˆ
| é …ç›® | æ•°å€¤ |
|-----|-----|
| Phase 1ãƒ†ã‚¹ãƒˆ | 24 |
| Phase 2ãƒ†ã‚¹ãƒˆ | +7 |
| **ç·ãƒ†ã‚¹ãƒˆæ•°** | **31** |
| ãƒ‘ã‚¹ç‡ | **100%** |
| å®Ÿè¡Œæ™‚é–“ | 27.33ç§’ |
| ã‚«ãƒãƒ¬ãƒƒã‚¸ | 94% (adjust) |

---

## ğŸŒŸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ

### Before (adjustæ©Ÿèƒ½ãªã—)
- å…¨ä½“ã‚’ä¸€ã‹ã‚‰å†è¨ˆç®—
- æ™‚é–“ãŒã‹ã‹ã‚‹
- äººé–“ã®åˆ¤æ–­ã‚’åæ˜ ã—ã¥ã‚‰ã„
- æ®µéšçš„æ”¹å–„ãŒå›°é›£

### After (adjustæ©Ÿèƒ½ã‚ã‚Š)
- âœ… **éƒ¨åˆ†çš„ãªèª¿æ•´**ãŒå¯èƒ½
- âœ… **é«˜é€Ÿ**ï¼ˆå·®åˆ†ã®ã¿å†è¨ˆç®—ï¼‰
- âœ… **äººé–“ã¨AIã®å”èª¿**
- âœ… **æ®µéšçš„ãªæœ€é©åŒ–**

---

## ğŸŠ å®Œäº†å®£è¨€

**`agrr optimize adjust` æ©Ÿèƒ½ã¯ã€Phase 1 & 2ã‚’å®Œäº†ã—ã€æ­£å¼ãƒªãƒªãƒ¼ã‚¹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚**

### å®Ÿè£…å®Œäº†: 100% âœ…
- Entityå±¤: 100%
- UseCaseå±¤: 100%
- Adapterå±¤: 100%
- Frameworkå±¤: 100%

### ãƒ†ã‚¹ãƒˆå®Œäº†: 103% âœ…
- Phase 1: 100%
- Phase 2: 100%
- åˆè¨ˆ: 31 tests (è¨ˆç”»30)

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œäº†: 100% âœ…
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰: å®Œæˆ
- ãƒ†ã‚¹ãƒˆä»•æ§˜: å®Œæˆ
- å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ: å®Œæˆ
- æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆ: å®Œæˆ

---

**ğŸ‰ Phase 1 & 2 å®Œäº† - æ­£å¼ãƒªãƒªãƒ¼ã‚¹æº–å‚™å®Œäº†ï¼ ğŸš€**

