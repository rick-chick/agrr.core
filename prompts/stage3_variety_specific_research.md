# Step 3: 生育ステージ要件詳細化・構造化プロンプト

## プロンプトテンプレート

```
【{ステージ名}期間の詳細要件調査・構造化】

対象: {作物名} {品種名}

以下のステージについて詳細要件を調査し、JSON形式で出力してください：

### 対象ステージ
- **ステージ名**: {具体的なステージ名}
- **特徴**: {具体的な特徴}

### 調査項目
以下の項目について品種の育成背景、遺伝的特性、栽培特性を学術論文や品種登録情報から詳細に調査してください：

#### 1. 温度要件
- **最適温度範囲**: 昼間/夜間の最適温度
- **基準温度（base_temperature）**: 生育が可能な最低限界温度
  - 定義：この温度以下では成長が停止する
  - GDD計算の基準として使用される
- **低温ストレス閾値**: 生育阻害を受ける最低温度
  - 定義：基準温度より高いが、生育に悪影響が出始める温度
- **高温ストレス閾値**: 生育阻害を受ける最高温度
  - 定義：生育に悪影響が出始める高温側の温度
- **霜害リスク温度**: 霜害を受ける危険温度
  - 定義：凍害により組織が損傷する温度
- **高温障害**: 不稔リスク温度（開花・結実期の場合）
  - 定義：高温により受粉・受精が阻害される危険温度

#### 2. 日照要件
- **最低日照時間**: 生育に必要な最低日照時間（時間）
- **目標日照時間**: 最適な生育のための目標日照時間（時間）

#### 3. 積算温度
- **必要積算温度（GDD）**: 日平均気温から基準温度を引いた値の累積（°C・日）
  - 計算式：GDD = Σ(日平均気温 - 基準温度)
  - 説明：各ステージに必要な熱エネルギーの総量

### 出力形式（JSON）
以下のJSON形式で出力してください：

```json
{
  "stage_name": "{ステージ名}",
  "temperature": {
    "base_temperature": {基準温度},
    "optimal_min": {最適最低温度},
    "optimal_max": {最適最高温度},
    "low_stress_threshold": {低温ストレス閾値},
    "high_stress_threshold": {高温ストレス閾値},
    "frost_threshold": {霜害リスク閾値},
    "sterility_risk_threshold": {不稔リスク閾値（該当する場合のみ）}
  },
  "sunshine": {
    "minimum_sunshine_hours": {最低日照時間},
    "target_sunshine_hours": {目標日照時間}
  },
  "thermal": {
    "required_gdd": {必要積算温度}
  }
}
```

### 日照時間設定指針（一般的な野菜作物の基準）
- **高要求（果菜類）**: minimum=4h, target=8h
  - 対象：トマト、キュウリ、ナス、ピーマン等
  - 根拠：光合成による果実肥大に多くの光エネルギーが必要
  
- **中要求（葉菜類）**: minimum=3h, target=6h
  - 対象：レタス、キャベツ、ホウレンソウ等
  - 根拠：葉の成長には中程度の光エネルギーが必要
  
- **低要求（根菜類）**: minimum=2h, target=4h
  - 対象：ニンジン、ダイコン、ゴボウ等
  - 根拠：地下部の成長が主で、光要求は比較的低い

### 注意事項
- 指定されたステージに特化した調査
- 品種の育成背景、遺伝的特性、栽培特性を学術論文や品種登録情報から詳細に調査
- 地域や栽培方式は考慮しない
- 学術的な根拠に基づいて推定値を設定
- 開花・結実期のステージでは高温障害の閾値を必ず設定し、その他の特殊要件も明記
- 積算温度は品種の遺伝的特性として調査
- 有効なJSON形式で出力し、数値は小数点以下1桁まで
- 不明な項目はnullを設定
- 出力前にJSON形式の妥当性を確認すること
```

## 使用例

### 例1: トマト アイコ - 播種～育苗完了ステージ
```
【播種～育苗完了ステージの詳細要件調査・構造化】

対象: トマト アイコ

以下のステージについて詳細要件を調査し、JSON形式で出力してください：

### 対象ステージ
- **ステージ名**: 播種～育苗完了
- **特徴**: 発芽から本葉5-6枚まで、定植適期

[上記テンプレート内容]
```

### 例2: レタス サニーレタス - 播種～収穫適期ステージ
```
【播種～収穫適期ステージの詳細要件調査・構造化】

対象: レタス サニーレタス

以下のステージについて詳細要件を調査し、JSON形式で出力してください：

### 対象ステージ
- **ステージ名**: 播種～収穫適期
- **特徴**: 発芽から葉数増加、収穫適期まで

[上記テンプレート内容]
```

## 期待される出力例

### 例1: トマト アイコ - 播種～育苗完了ステージ
```json
{
  "stage_name": "播種～育苗完了",
  "temperature": {
    "base_temperature": 10.0,
    "optimal_min": 20.0,
    "optimal_max": 25.0,
    "low_stress_threshold": 8.0,
    "high_stress_threshold": 30.0,
    "frost_threshold": 0.0,
    "sterility_risk_threshold": null
  },
  "sunshine": {
    "minimum_sunshine_hours": 4.0,
    "target_sunshine_hours": 8.0
  },
  "thermal": {
    "required_gdd": 300.0
  }
}
```

### 例2: レタス サニーレタス - 播種～収穫適期ステージ
```json
{
  "stage_name": "播種～収穫適期",
  "temperature": {
    "base_temperature": 5.0,
    "optimal_min": 18.0,
    "optimal_max": 22.0,
    "low_stress_threshold": 0.0,
    "high_stress_threshold": 25.0,
    "frost_threshold": -2.0,
    "sterility_risk_threshold": null
  },
  "sunshine": {
    "minimum_sunshine_hours": 3.0,
    "target_sunshine_hours": 6.0
  },
  "thermal": {
    "required_gdd": 600.0
  }
}
```
