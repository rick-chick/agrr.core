# 天気予測データの精度検証レポート

**作成日**: 2025年10月14日  
**データファイル**: `test_data/optimization_weather_1760421725.json`  
**検証方法**: 実測データとの比較による精度評価

---

## エグゼクティブサマリー

### 主要な発見

1. ✅ **過去データ（9.5ヶ月）の予測精度は良好**
   - 気温誤差: 約1°C（MAE=1.08°C）
   - GDD累積誤差: +7.2%
   
2. ⚠️ **系統的な暖かめバイアスが存在**
   - 平均+0.81°C高く予測
   - 結果として栽培日数を23日短く見積もる

3. 🚨 **未来期間（14.7ヶ月先）の信頼性は未検証**
   - 過去期間の精度は保証されない
   - 気象学的に1年先の日単位予測は困難

---

## データ概要

### 対象データ

| 項目 | 値 |
|------|-----|
| データ期間 | 2025年1月1日 〜 2026年12月29日 |
| 総日数 | 725日 |
| 地域 | 緯度40.8244, 経度140.74（青森県付近） |
| ファイル作成日時 | 2025年10月14日 15:02:05 |

### 検証期間

| 項目 | 値 |
|------|-----|
| 過去データ | 2025年1月1日 〜 10月14日（287日、検証済み） |
| **未来データ** | **2025年10月15日 〜 2026年12月29日（441日、未検証）** |

---

## 精度検証結果

### 1. 気温予測精度（過去287日間）

| 指標 | 最高気温 | 最低気温 | **平均気温** |
|------|----------|----------|--------------|
| 平均絶対誤差 (MAE) | 1.67°C | 1.14°C | **1.08°C** |
| 二乗平均平方根誤差 (RMSE) | 2.00°C | 1.57°C | **1.33°C** |
| 平均バイアス | +1.15°C | +0.71°C | **+0.81°C** |
| 最大誤差 | 5.40°C | 7.40°C | **4.51°C** |

**評価**: ✅ **良好**（一般的な天気予報の基準で「実用的な精度」）

#### 参考：天気予報の精度基準

| ランク | MAE | RMSE | 該当例 |
|--------|-----|------|--------|
| 優秀 | < 1.0°C | < 1.5°C | 短期予報（3日以内） |
| **良好** | **< 2.0°C** | **< 2.5°C** | **本データ（中期予報レベル）** |
| 普通 | < 3.0°C | < 4.0°C | 1ヶ月予報 |
| 不良 | ≥ 3.0°C | ≥ 4.0°C | - |

### 2. 季節別の精度

| 季節 | 気温MAE | 気温バイアス | GDD MAE | GDD バイアス |
|------|---------|--------------|---------|--------------|
| 冬季（1-3月） | 1.16°C | +1.03°C | 0.02 | +0.02 |
| 春季（4-6月） | 0.91°C | +0.34°C | 0.76 | +0.24 |
| 夏季（7-9月） | 1.15°C | +1.00°C | 1.15 | +1.00 |
| 秋季（10月） | 1.19°C | +1.19°C | 1.19 | +1.19 |

**観察**:
- 全季節で**系統的に暖かめに予測**（+0.34°C 〜 +1.19°C）
- 春季の精度が最も高い
- 冬季はGDD誤差が小さい（基準温度10°C以下のため）

### 3. GDD（積算温度）への影響

#### 検証期間（287日間）の累積GDD

| 項目 | 値 |
|------|-----|
| 累積GDD（実測値） | 1,818.6度日 |
| 累積GDD（予測値） | 1,950.3度日 |
| **累積誤差** | **+131.7度日 (+7.2%)** |

#### キュウリ栽培への影響

| 項目 | 実測ベース | 予測ベース | 差 |
|------|-----------|-----------|-----|
| 必要GDD | 2,200度日 | 2,200度日 | - |
| 達成率 | 82.7% | 88.7% | +6.0%pt |
| 平均GDD/日 | 6.34度日 | 6.80度日 | +0.46度日 |
| **推定必要日数** | **347日** | **324日** | **-23日** |

**重要**: 予測データは栽培期間を**23日短く見積もる傾向**があります。

---

## サンプル比較（2025年1月）

| 日付 | 実測(°C) | 予測(°C) | 誤差(°C) |
|------|----------|----------|----------|
| 2025-01-01 | -1.0 | 0.0 | +1.0 |
| 2025-01-02 | -2.1 | -1.0 | +1.1 |
| 2025-01-03 | -4.5 | -2.8 | +1.7 |
| 2025-01-04 | -3.8 | -2.5 | +1.3 |
| 2025-01-05 | -0.6 | -0.9 | -0.3 |
| 2025-01-06 | 3.1 | 1.6 | -1.5 |
| 2025-01-07 | 2.7 | 2.6 | -0.1 |
| 2025-01-08 | -1.2 | 0.0 | +1.2 |
| 2025-01-09 | -1.8 | -1.2 | +0.6 |
| 2025-01-10 | -1.9 | -0.2 | +1.7 |

**平均誤差**: +0.99°C（暖かめ）

---

## 未来予測期間の信頼性評価

### 検証済み vs 未検証

```
┌─────────────────────────────────────────────────────────────────┐
│ タイムライン                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  2025-01-01                2025-10-14                2026-12-29 │
│      │─────── 287日 ────────│──────── 441日 ──────────│        │
│      │                      │                         │        │
│      │  ✅ 検証済み期間      │  ❓ 未検証期間          │        │
│      │  (精度良好)           │  (精度不明)             │        │
│      │  MAE=1.08°C          │  MAE=???                │        │
│      │                      │                         │        │
│      └──────────────────────┴─────────────────────────┘        │
│                                                                 │
│       過去実測データ              未来予測データ                │
│       (Archive API?)             (予測モデル?)                 │
└─────────────────────────────────────────────────────────────────┘
```

### 未来期間の推定精度

過去データの傾向から、未来期間の精度を推定：

| 要因 | 影響 |
|------|------|
| 予測期間の延長 | 過去9.5ヶ月 → 未来14.7ヶ月（1.5倍） |
| 季節の繰り返し | 冬季を2回含む（不確実性増） |
| 長期予測の限界 | 気象学的に日単位精度は困難 |

**推定される影響**:
- 気温誤差: MAE 1.08°C → **2-3°C程度に拡大**の可能性
- GDD誤差: +7.2% → **±10-20%程度に拡大**の可能性
- 栽培日数誤差: -23日 → **±40-80日程度**の不確実性

---

## データソースの推定

### ファイル情報から

- ファイル作成日時: **2025年10月14日 15:02:05**
- データ期間: 2025年1月1日 〜 2026年12月29日

### 可能性の高いシナリオ

#### シナリオ1: Archive + Forecast の組み合わせ（最も可能性高）

```
過去部分（2025-01-01 〜 2025-10-14）:
  → Open-Meteo Archive API（実測データ）
  → 精度が良好（MAE=1.08°C）であることと一致

未来部分（2025-10-15 〜 2026-12-29）:
  → Open-Meteo Forecast API または 気候モデル
  → 精度は未検証
```

#### シナリオ2: 過去の実測データを使用

```
2024年のデータを2025-2026年として使用
  → 過去の気候パターンを将来に適用
  → 農業計画では一般的な手法
```

#### シナリオ3: 予測モデル（ARIMA等）

```
過去データから未来を予測
  → agrr predict コマンドの使用？
  → 通常は30-90日程度が限界
```

### 確認方法

以下のいずれかで確認可能:

1. **ファイル生成スクリプトを確認**
2. **APIレスポンスのメタデータを確認**
3. **2024年の実測データと比較**

---

## 409日栽培計画への影響

### 現在の計画

- 開始日: 2025年6月5日
- 完了日: 2026年7月18日
- 栽培日数: **409日**

### 予測誤差の影響

```
誤差要因の累積:

1. 過去期間（2025-06-05 〜 2025-10-14）: 132日
   → GDD誤差: 約+7%
   → 影響: 比較的小さい

2. 未来期間（2025-10-15 〜 2026-07-18）: 277日（67%）
   → GDD誤差: 推定±10-20%
   → 影響: 大きい

推定される栽培期間の不確実性:
  - 楽観ケース（予測が正確）: 約390日
  - 標準ケース: 約410日
  - 悲観ケース（寒冬）: 約450-500日

→ 不確実性の幅: ±40-90日
```

### リスク

1. **完了日の遅延リスク**
   - 実際の気温が予測より低い場合
   - 栽培期間が450-500日に延長の可能性
   - 2026年末までに収穫できない可能性

2. **収益計算の誤差**
   - 固定費の増加（日数×125円/日）
   - 予測では51,125円 → 実際は56,000-62,500円の可能性

3. **次作への影響**
   - 圃場の空き時間が短縮
   - 輪作計画への波及

---

## 結論

### 1. 過去データの精度は良好

✅ **MAE=1.08°C、RMSE=1.33°C** は実用的な精度
- 短期予報ほどではないが、中期予報レベル
- 過去期間の分析には使用可能

### 2. しかし、系統的バイアスが存在

⚠️ **平均+0.81°C暖かめに予測**
- GDDを+7.2%過大評価
- 栽培日数を-23日短く見積もる傾向

### 3. 未来期間の信頼性は大幅に低下

❌ **14.7ヶ月先の日単位予測は気象学的に困難**
- 過去の精度は保証されない
- 推定誤差: ±10-20%（GDD）
- 栽培日数の不確実性: ±40-90日

---

## 推奨事項

### A. 即座に実施すべき対策

#### 1. データソースの明確化

```bash
# このファイルがどのように作成されたかを確認
# - Archive API + Forecast API?
# - 過去データの再利用?
# - 予測モデル?
```

#### 2. 複数年の実測データを使用（推奨）

```bash
# 2023年の実測データを取得
agrr weather --location 40.8244,140.74 \
  --start-date 2023-01-01 --end-date 2023-12-31 \
  --json > weather_2023_actual.json

# 2024年の実測データを取得
agrr weather --location 40.8244,140.74 \
  --start-date 2024-01-01 --end-date 2024-12-31 \
  --json > weather_2024_actual.json

# 2年分の平均を使用（より安定）
```

#### 3. バイアス補正

予測データに-0.81°Cのオフセットを適用:

```python
# 簡易的な補正
adjusted_temp = forecast_temp - 0.81
```

### B. 中期的改善（システムレベル）

#### 1. 複数シナリオ分析

```
標準シナリオ: 平年値
暖冬シナリオ: 平年値 + 2°C
厳冬シナリオ: 平年値 - 2°C
```

#### 2. 不確実性の可視化

```
最適栽培期間: 409日 ± 45日 (95%信頼区間)
収益: -31,125円 ± 5,600円
```

#### 3. 感度分析

気温が±1°C変化した場合の影響を評価

### C. 長期的改善（将来機能）

#### 1. 確率的最適化

- モンテカルロシミュレーション
- 過去データの分布から天気をサンプリング
- リスク指標（VaR、CVaR）の計算

#### 2. 動的計画

- 実際の天気データで定期的に再最適化
- 進捗状況をモニタリング
- 計画の柔軟な調整

#### 3. 気候データベースの統合

- 気象庁の平年値データ
- Open-Meteo Climate API
- 長期統計データ

---

## 付録

### 分析に使用したツール

1. `compare_forecast_accuracy.py`: 予測精度の基本分析
2. `analyze_forecast_impact.py`: GDD影響分析
3. `debug_allocation.py`: 配分最適化のデバッグ（削除済み）

### データファイル

- `test_data/optimization_weather_1760421725.json`: 検証対象データ
- `test_data/weather_actual_2025.json`: 実測データ（比較用）
- `test_data/crops_1760421725.json`: 作物データ
- `test_data/fields_1760421725.json`: 圃場データ

### 参考文献

- Open-Meteo API Documentation
- 気象庁 長期予報の手引き
- 農業気象学における積算温度の利用

---

**作成者**: AI分析システム  
**検証日**: 2025年10月14日  
**バージョン**: 1.0

